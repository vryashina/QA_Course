Задание 1
Âûâåñòè èìåíà âñåõ êîãäà-ëèáî îáñëóæèâàåìûõ ïàññàæèðîâ àâèàêîìïàíèé

select name from passenger

Çàäàíèå 2
Âûâåñòè íàçâàíèÿ âñåx àâèàêîìïàíèé

select name from company

Çàäàíèå 3
Âûâåñòè âñå ðåéñû, ñîâåðøåííûå èç Ìîñêâû

select * from Trip
where town_from = 'Moscow'

Çàäàíèå 4
Âûâåñòè èìåíà ëþäåé, êîòîðûå çàêàí÷èâàþòñÿ íà "man"

select name from Passenger
where name like '%man'

Çàäàíèå 5
Âûâåñòè êîëè÷åñòâî ðåéñîâ, ñîâåðøåííûõ íà TU-134

select count(plane) as count from Trip
where plane = 'TU-134'

çàäàíèå 6
Êàêèå êîìïàíèè ñîâåðøàëè ïåðåëåòû íà Boeing

select distinct name from company
join trip on company.id = trip.company
where plane = 'Boeing'

Çàäàíèå 7
Âûâåñòè âñå íàçâàíèÿ ñàìîë¸òîâ, íà êîòîðûõ ìîæíî óëåòåòü â Ìîñêâó (Moscow)

select distinct plane from Trip
where town_to = 'Moscow'

Çàäàíèå 8
Â êàêèå ãîðîäà ìîæíî óëåòåòü èç Ïàðèæà (Paris) è ñêîëüêî âðåìåíè ýòî çàéì¸ò?

SELECT town_to, timediff(time_in, time_out) AS flight_time
FROM trip JOIN company ON trip.company = company.id
WHERE trip.town_from = 'Paris';

Çàäàíèå 9
Êàêèå êîìïàíèè îðãàíèçóþò ïåðåëåòû ñ Âëàäèâîñòîêà (Vladivostok)?

select name from company join trip on company.id = trip.company
where town_from = 'Vladivostok'

Çàäàíèå 10
Âûâåñòè âûëåòû, ñîâåðøåííûå ñ 10 ÷. ïî 14 ÷. 1 ÿíâàðÿ 1900 ã.

select * from Trip
where time_out between '1900-01-01T10:00:00.000Z' and '1900-01-01T14:00:00.000Z'

Çàäàíèå 11
Âûâåñòè ïàññàæèðîâ ñ ñàìûì äëèííûì èìåíåì

SELECT name
  FROM passenger
 WHERE LENGTH(name) =
       (SELECT MAX (LENGTH (name)) FROM passenger)

Çàäàíèå 12
Âûâåñòè id è êîëè÷åñòâî ïàññàæèðîâ äëÿ âñåõ ïðîøåäøèõ ïîë¸òîâ

select trip, count(id) as count from Pass_in_trip
group by trip

Çàäàíèå 13
Âûâåñòè èìåíà ëþäåé, ó êîòîðûõ åñòü ïîëíûé ò¸çêà ñðåäè ïàññàæèðîâ

select name from passenger group by name
having count(*)>1

Çàäàíèå 14(îáúåäèíåíèå òðåõ òàáëèö)
Â êàêèå ãîðîäà ëåòàë Bruce Willis

SELECT town_to FROM trip
JOIN pass_in_trip ON trip.id = pass_in_trip.trip
JOIN passenger ON pass_in_trip.passenger = passenger.id
WHERE passenger.name='Bruce Willis'

Çàäàíèå 15
Âî ñêîëüêî Ñòèâ Ìàðòèí (Steve Martin) ïðèëåòåë â Ëîíäîí (London)

select time_in from trip
join Pass_in_trip on trip.id = Pass_in_trip.trip
join passenger on Pass_in_trip.passenger = Passenger.id
where name = 'Steve Martin' and town_to = 'London'

Çàäàíèå 16
Âûâåñòè îòñîðòèðîâàííûé ïî êîëè÷åñòâó ïåðåëåòîâ (ïî óáûâàíèþ) è èìåíè (ïî âîçðàñòàíèþ) ñïèñîê ïàññàæèðîâ, ñîâåðøèâøèõ õîòÿ áû 1 ïîëåò.

select name, count(trip) as count from passenger
join pass_in_trip on passenger.id = pass_in_trip.passenger
join trip on pass_in_trip.trip = trip.id
group by name
having count(*) >= 1
order by count desc, name ASC

Çàäàíèå 17
Îïðåäåëèòü, ñêîëüêî ïîòðàòèë â 2005 ãîäó êàæäûé èç ÷ëåíîâ ñåìüè

select member_name, status, sum(unit_price*amount) as costs from familymembers
join payments on familymembers.member_id = payments.family_member
where date between '2005-01-01T00:00:00.000Z' and '2005-12-31T23:59:59.000Z'
group by member_name, status
order by costs asc

Çàäàíèå 19
Îïðåäåëèòü, êòî èç ÷ëåíîâ ñåìüè ïîêóïàë êàðòîøêó (potato)

select distinct status from familymembers
join payments on familymembers.member_id = payments.family_member
join goods on payments.good = goods.good_id
where good_name = 'potato'

Çàäàíèå 20
Ñêîëüêî è êòî èç ñåìüè ïîòðàòèë íà ðàçâëå÷åíèÿ (entertainment). Âûâåñòè ñòàòóñ â ñåìüå, èìÿ, ñóììó

select status, member_name, sum(unit_price*amount) as costs from familymembers
join payments on familymembers.member_id = payments.family_member
join goods on payments.good = goods.good_id
join goodtypes on goods.type = goodtypes.good_type_id
where good_type_name = 'entertainment'
group by status, member_name

Çàäàíèå 21
Îïðåäåëèòü òîâàðû, êîòîðûå ïîêóïàëè áîëåå 1 ðàçà

select good_name from goods join payments on goods.good_id = payments.good
group by good_name
having count(*) > 1

Çàäàíèå 22
Íàéòè èìåíà âñåõ ìàòåðåé (mother)

select member_name from FamilyMembers
where status = 'mother'

Çàäàíèå 23
Íàéäèòå ñàìûé äîðîãîé äåëèêàòåñ (delicacies) è âûâåäèòå åãî ñòîèìîñòü

select good_name,unit_price from goods
join goodtypes on goods.type = goodtypes.good_type_id
join payments on goods.good_id = payments.good
where unit_price = (select max(unit_price) from payments
join goods on payments.good = goods.good_id
join goodtypes on goods.type = goodtypes.good_type_id
where good_type_name = 'delicacies' )

Çàäàíèå 24
Îïðåäåëèòü êòî è ñêîëüêî ïîòðàòèë â èþíå 2005

select member_name, sum(unit_price*amount) as costs from familymembers
join payments on familymembers.member_id = payments.family_member
join goods on payments.good = goods.good_id
join goodtypes on goods.type = goodtypes.good_type_id
where date between '2005-06-01T00:00:00.000Z' and '2005-06-30T23:59:59.000Z'
group by member_name

Çàäàíèå 25
Îïðåäåëèòü, êàêèå òîâàðû èìåþòñÿ â òàáëèöå Goods, íî íå ïîêóïàëèñü â òå÷åíèå 2005 ãîäà

SELECT good_name
FROM Goods
WHERE good_id not in
(SELECT good from Payments WHERE YEAR(date) = 2005);

Çàäàíèå 26
Îïðåäåëèòü ãðóïïû òîâàðîâ, êîòîðûå íå ïðèîáðåòàëèñü â 2005 ãîäó

SELECT good_type_name
FROM GoodTypes
WHERE good_type_id NOT IN (
SELECT good_type_id
FROM Goods
JOIN Payments ON good_id = good AND YEAR(date) = 2005
JOIN GoodTypes ON good_type_id = type
)

Çàäàíèå 27
Óçíàòü, ñêîëüêî ïîòðà÷åíî íà êàæäóþ èç ãðóïï òîâàðîâ â 2005 ãîäó. Âûâåñòè íàçâàíèå ãðóïïû è ñóììó

select good_type_name, sum(unit_price*amount) as costs from goodtypes
join goods on goodtypes.good_type_id = goods.type
join payments on goods.good_id = payments.good
where date BETWEEN "2005-01-01T00:00:00.000Z" AND "2005-12-31T00:00:00.000Z"
group by good_type_name

Çàäàíèå 28
Ñêîëüêî ðåéñîâ ñîâåðøèëè àâèàêîìïàíèè ñ Ðîñòîâà (Rostov) â Ìîñêâó (Moscow) ?

select count(plane) as count from Trip
where town_from = 'Rostov' and town_to = 'Moscow'

Çàäàíèå 29
Âûâåäèòå èìåíà ïàññàæèðîâ óëåòåâøèõ â Ìîñêâó (Moscow) íà ñàìîëåòå TU-134

select distinct name from passenger
join pass_in_trip on passenger.id = pass_in_trip.passenger
join trip on pass_in_trip.trip = trip.id
where plane = 'TU-134' and town_to = 'Moscow'
order by name asc

Çàäàíèå 30
Âûâåäèòå íàãðóæåííîñòü (÷èñëî ïàññàæèðîâ) êàæäîãî ðåéñà (trip). Ðåçóëüòàò âûâåñòè â îòñîðòèðîâàííîì âèäå ïî óáûâàíèþ íàãðóæåííîñòè.

select distinct trip, count(passenger) as count from pass_in_trip
group by trip
order by count desc

Çàäàíèå 31
Âûâåñòè âñåõ ÷ëåíîâ ñåìüè ñ ôàìèëèåé Quincey.

select * from FamilyMembers
where member_name like '%_Quincey'

Çàäàíèå 34
Ñêîëüêî âñåãî 10-ûõ êëàññîâ

select count(name) as count from Class
where name like '10%'

Çàäàíèå 35
Ñêîëüêî ðàçëè÷íûõ êàáèíåòîâ øêîëû èñïîëüçîâàëèñü 2.09.2019 â îáðàçîâàòåëüíûõ öåëÿõ ?

select distinct count(classroom) as count from Schedule
where date = '2019-09-02T00:00:00.000Z'

Çàäàíèå 36
Âûâåäèòå èíôîðìàöèþ îá îáó÷àþùèõñÿ æèâóùèõ íà óëèöå Ïóøêèíà (ul. Pushkina)?

select * from Student
where address like 'ul. Pushkina, %'

Çàäàíèå 38
Ñêîëüêî Àíí (Anna) ó÷èòñÿ â øêîëå ?

select count(first_name) as count from Student
where first_name = 'Anna'

Çàäàíèå 39
Ñêîëüêî îáó÷àþùèõñÿ â 10 B êëàññå ?

select count(student) as count from student_in_class
join class on student_in_class.class = class.id
where class.id = 6

Çàäàíèå 40
Âûâåäèòå íàçâàíèå ïðåäìåòîâ, êîòîðûå ïðåïîäàåò Ðîìàøêèí Ï.Ï. (Romashkin P.P.) ?

select name as subjects from subject
join schedule on subject.id = schedule.subject
join teacher on schedule.teacher = teacher.id
where last_name = 'Romashkin'

Çàäàíèÿ 41
Âî ñêîëüêî íà÷èíàåòñÿ 4-ûé ó÷åáíûé ïðåäìåò ïî ðàñïèñàíèþ ?

select start_pair from Timepair
where id = 4

Çàäàíèå 43
Âûâåäèòå ôàìèëèè ïðåïîäàâàòåëåé, êîòîðûå âåäóò ôèçè÷åñêóþ êóëüòóðó (Physical Culture). Îñòîðòèðóéòå ïðåïîäàâàòåëåé ïî ôàìèëèè.

select last_name from teacher
join schedule on teacher.id = schedule.teacher
join subject on schedule.subject = subject.id
where subject.name = 'Physical Culture'
order by last_name asc

Çàäàíèå 46
Â êàêèõ êëàññàõ ââåäåò çàíÿòèÿ ïðåïîäàâàòåëü "Krauze" ?

select distinct name from class
join schedule on class.id = schedule.class
join teacher on schedule.teacher = teacher.id
where last_name = 'Krauze'


Çàäàíèå 47
Ñêîëüêî çàíÿòèé ïðîâåë Krauze 30 àâãóñòà 2019 ã.?

select count(number_pair) as count from schedule
join teacher on schedule.teacher = teacher.id
where last_name = 'Krauze' and (date between '2019-08-30T00:00:00.000Z' and '2019-08-30T23:59:59.000Z')


Çàäàíèå 48
Âûâåäèòå çàïîëíåííîñòü êëàññîâ â ïîðÿäêå óáûâàíèÿ

select name, count(student) as count from class
join student_in_class on class.id = student_in_class.class
group by name
order by count desc


Çàäàíèå 59
Âûâåñòè ïîëüçîâàòåëåé,óêàçàâøèõ Áåëîðóññêèé íîìåð òåëåôîíà ? Òåëåôîííûé êîä Áåëîðóññèè +375.

select * from Users
where phone_number like '+375%'
